<%if (typeof cart !== "undefined") {%>
<h3>Shopping Cart</h3>
    <table>
        <tr>
            <th>Image</th>
            <th>Title</th>
            <th>Price</th>
            <th>Quantity</th>
            <th></th>
            <th>Subtotal</th>
        </tr>
        <%let total = 0%>
        <%cart.forEach(product => {%>
            <%let subtotal = parseFloat(product.qty * product.price).toFixed(2)%>
            <%total += +subtotal * 1.11%>
            <tr>
                <td><img height="150" width="100" src="<%=product.image%>" alt="products images"></td>
                <td><%=product.title%></td>
                <td>CDN$ <%=product.price%></td>
                <td><%=product.qty%></td>
                <td><input type="number" min="0" value="<%=product.qty%>"></td>
                <td>
                    <a href="/cart/update/<%=product.title%>?action=add">+</a>
                    <a href="/cart/update/<%=product.title%>?action=remove">-</a>
                    <a href="/cart/update/<%=product.title%>?action=clear">Clear</a>
                </td>
                <td>CDN$ <%=subtotal%></td>
            </tr>
        <%})%>
        <td style="float: right; text-align: right; font-size: 30pt; color: red">Total: $<%=total.toFixed(2)%></td>
        <td>
            <a href="/cart/clear">Clear Cart</a>
        </td>
        <td>
            <a href="#">Place your order</a>
        </td>
    </table>
<%}else {%>
    <h3>Your cart is empty.</h3>
<%}%>